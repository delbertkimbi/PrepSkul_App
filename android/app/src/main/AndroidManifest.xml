<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools">
    <!-- Permissions for file access, camera, and storage -->
    <uses-permission android:name="android.permission.INTERNET"/>
    
    <!-- Storage permissions for Android 12 and below only -->
    <!-- Android 13+ will use Photo Picker automatically (no permission needed) -->
    <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE"/>
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" android:maxSdkVersion="32"/>
    
    <!-- EXPLICITLY REMOVE: READ_MEDIA_IMAGES - Using Android Photo Picker instead (no permission needed on Android 13+) -->
    <!-- This prevents plugins (like image_picker) from automatically adding these permissions -->
    <uses-permission 
        android:name="android.permission.READ_MEDIA_IMAGES"
        tools:node="remove" />
    
    <!-- EXPLICITLY REMOVE: READ_MEDIA_VIDEO - Using Android Photo Picker instead (no permission needed on Android 13+) -->
    <!-- This prevents plugins (like image_picker) from automatically adding these permissions -->
    <uses-permission 
        android:name="android.permission.READ_MEDIA_VIDEO"
        tools:node="remove" />
    
    <!-- The image_picker package will automatically use Photo Picker on Android 13+ when these permissions are not declared -->
    
    <!-- Camera permission: Required for tutors to take profile photos and upload verification documents (ID cards, certificates) during onboarding -->
    <uses-permission android:name="android.permission.CAMERA"/>
    
    <!-- Location permissions: Required to show session locations on maps and help users navigate to onsite tutoring sessions -->
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
    
    <!-- Camera hardware is optional - app works without camera but with limited functionality -->
    <uses-feature android:name="android.hardware.camera" android:required="false"/>
    <uses-feature android:name="android.hardware.camera.autofocus" android:required="false"/>
    
    <application
        android:label="prepskul"
        android:name="${applicationName}"
        android:icon="@mipmap/ic_launcher">
        <activity
            android:name=".MainActivity"
            android:exported="true"
            android:launchMode="singleTop"
            android:taskAffinity=""
            android:theme="@style/LaunchTheme"
            android:configChanges="orientation|keyboardHidden|keyboard|screenSize|smallestScreenSize|locale|layoutDirection|fontScale|screenLayout|density|uiMode"
            android:hardwareAccelerated="true"
            android:windowSoftInputMode="adjustResize">
            <!-- Specifies an Android theme to apply to this Activity as soon as
                 the Android process has started. This theme is visible to the user
                 while the Flutter UI initializes. After that, this theme continues
                 to determine the Window background behind the Flutter UI. -->
            <meta-data
              android:name="io.flutter.embedding.android.NormalTheme"
              android:resource="@style/NormalTheme"
              />
            <intent-filter>
                <action android:name="android.intent.action.MAIN"/>
                <category android:name="android.intent.category.LAUNCHER"/>
            </intent-filter>
            <!-- Deep Links for PrepSkul Auth -->
            <intent-filter>
                <action android:name="android.intent.action.VIEW" />
                <category android:name="android.intent.category.DEFAULT" />
                <category android:name="android.intent.category.BROWSABLE" />
                <data android:scheme="prepskul" />
            </intent-filter>
            <!-- Universal Links for PrepSkul -->
            <intent-filter android:autoVerify="true">
                <action android:name="android.intent.action.VIEW" />
                <category android:name="android.intent.category.DEFAULT" />
                <category android:name="android.intent.category.BROWSABLE" />
                <data
                    android:scheme="https"
                    android:host="app.prepskul.com" />
            </intent-filter>
        </activity>
        <!-- Don't delete the meta-data below.
             This is used by the Flutter tool to generate GeneratedPluginRegistrant.java -->
        <meta-data
            android:name="flutterEmbedding"
            android:value="2" />
        <!-- Google Maps API Key -->
        <!-- TODO: Replace YOUR_GOOGLE_MAPS_API_KEY with your actual API key from Google Cloud Console -->
        <!-- Get your key at: https://console.cloud.google.com/google/maps-apis/credentials -->
        <meta-data
            android:name="com.google.android.geo.API_KEY"
            android:value="YOUR_GOOGLE_MAPS_API_KEY" />
    </application>
    <!-- Required to query activities that can process text, see:
         https://developer.android.com/training/package-visibility and
         https://developer.android.com/reference/android/content/Intent#ACTION_PROCESS_TEXT.

         In particular, this is used by the Flutter engine in io.flutter.plugin.text.ProcessTextPlugin. -->
    <queries>
        <intent>
            <action android:name="android.intent.action.PROCESS_TEXT"/>
            <data android:mimeType="text/plain"/>
        </intent>
    </queries>
</manifest>
